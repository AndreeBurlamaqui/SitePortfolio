---
import BaseLayout from '../layouts/base-layout.astro'; // Use your shell
import '../styles/global.css';
import TechTags from '../components/tech-tags.astro';

import { getCollection } from 'astro:content';
const games = await getCollection('released-games');
const uiStudies = await getCollection('ui-studies');
---

<BaseLayout title="AndrÃ©e Burlamaqui - Portfolio">
  
  <div class="main-container">

    <main class="content-area">

      <div class="tabs-header">
        <button class="tab-btn active" data-target="tab-games">
            Released Games
        </button>
        <button class="tab-btn active" data-target="tab-prototypes">
            Prototypes
        </button>
        <button class="tab-btn" data-target="tab-ui">
            UI Studies
        </button>
      </div>

        <div id="tab-games" class="tab-content active">
        <div class="project-grid">
          {games.map(game => (
            <a href={`/released-games/${game.slug}`} class="project-card">
              <div class="card-image" style={`background-image: url(${game.data.cover || '/placeholder.jpg'})`}></div>
              <div class="card-info">

                <h3>{game.data.title}</h3>

                <TechTags rawTechStack={[
                    game.data.engine,
                    game.data.language,
                    game.data.role,
                    game.data.importantTechStack
                    ]}/>

                {game.data.itchUrl && (
      <span class="tag">
        <i class="fa-brands fa-steam"></i> Itch
      </span>
    )}
                {game.data.steamUrl && (
      <span class="tag">
        <i class="fa-brands fa-steam"></i> Steam
      </span>
    )}

    {game.data.googlePlayUrl && (
      <span class="tag">
        <i class="fa-brands fa-google-play"></i> Google Play
      </span>
    )}

    {game.data.applePlayUrl && (
      <span class="tag">
        <i class="fa-brands fa-apple"></i> App Store
      </span>
    )}
              </div>
            </a>
          ))}
        </div>
      </div>

      <div id="tab-ui" class="tab-content">
        <div class="project-grid">
          {uiStudies.map(study => (
            <a href={`/ui-studies/${study.slug}`} class="project-card">
              <div class="card-image" style={`background-image: url(${study.data.cover || '/placeholder.jpg'})`}></div>
              <div class="card-info">
                <h3>{study.data.title}</h3>

                <TechTags rawTechStack={study.data.importantTechStack}/>

              </div>
            </a>
          ))}
        </div>
      </div>

    </main>

  </div>

</BaseLayout>

<script>
    // Tabs
  const buttons = document.querySelectorAll('.tab-btn');
  const contents = document.querySelectorAll('.tab-content');

  buttons.forEach(btn => {
    btn.addEventListener('click', () => {
      buttons.forEach(b => b.classList.remove('active'));
      contents.forEach(c => c.classList.remove('active'));

      btn.classList.add('active');

const targetId = btn.getAttribute('data-target');
if (targetId) {
  document.getElementById(targetId)?.classList.add('active');
}
    });
  });

</script>

<style>
  /* --- TABS --- */
  .tabs-header {
    display: flex;
    gap: 2rem;
    margin-bottom: 2rem;
    border-bottom: 2px solid #eee;
  }

  .tab-btn {
    background: none;
    border: none;
    font-size: 1.2rem;
    font-weight: 600;
    padding-bottom: 1rem;
    cursor: pointer;
    color: #888;
    position: relative;
    top: 2px; /* Alignment trick */
  }

  .tab-btn:hover { color: #444; }

  /* The Active Tab Style */
  .tab-btn.active {
    color: #000;
    border-bottom: 2px solid #000; /* Black line under active tab */
  }

  /* --- TOGGLE LOGIC --- */
  .tab-content { display: none; } /* Hide by default */
  .tab-content.active { display: block; animation: fadeIn 0.3s ease; }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(5px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* --- GRID --- */
  .project-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); /* Responsive Grid */
    gap: 2rem;
  }

  .project-card {
    text-decoration: none;
    color: inherit;
    border: 1px solid #eee;
    border-radius: 12px;
    overflow: hidden;
    transition: transform 0.2s;
  }

  .project-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.05); }

  .card-image {
    height: 160px;
    background-size: cover;
    background-position: center;
    background-color: #ddd;
  }

  .card-info { padding: 1rem; }

</style>